{% extends "base.html" %}
{% block content %}
<div class="page-header">
    <div>
        <h2>Manual Control Interface</h2>
        <p class="sub-header">Direct drone operation and emergency override</p>
    </div>
    <!-- Control Mode Toggle (NEW) -->
    <div class="control-mode-toggle">
        <button id="joystick-toggle" class="toggle-btn active">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.25 12.25a2.5 2.5 0 0 1-5-2.5 2.5 2.5 0 0 1 5 2.5Z"></path><path d="M12.25 12.25a2.5 2.5 0 0 0-5-2.5 2.5 2.5 0 0 0 5 2.5Z"></path><path d="M14.25 10.25V7.5a2.5 2.5 0 0 0-5 0v2.75"></path><path d="m11.5 16.5-3.12-3.12"></path><path d="M8.38 13.38 5.5 10.5"></path><path d="M16.5 11.5 19 9"></path><path d="M22 2 12 12"></path></svg>
            Joystick
        </button>
        <button id="directional-toggle" class="toggle-btn">
             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v10"></path><path d="m16 6-4-4-4 4"></path><path d="M12 12H2"></path><path d="m6 8-4 4 4 4"></path><path d="M12 12v10"></path><path d="m8 18 4 4 4-4"></path><path d="M12 12h10"></path><path d="m18 16 4-4-4-4"></path></svg>
            Directional
        </button>
    </div>
    <div class="manual-status">
        <span>Connection: <strong>Not connected</strong></span>
        <span class="active-indicator">Manual Override: INACTIVE</span>
        <button class="btn btn-danger">Disable Override</button>
    </div>
</div>

<div class="manual-control-grid">
    <!-- Column 1: Flight Parameters (UPDATED) -->
    <div class="card">
        <div class="card-header"><h3>Flight Parameters</h3><span>Real-time telemetry data</span></div>
        <div class="card-body">
            <!-- Flight Dynamics -->
            <h4 class="param-group-header">Flight Dynamics</h4>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m5 12 7-7 7 7-7 7-7-7z"></path></svg> Speed</span><strong id="param-speed">8.0 m/s</strong></div>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L12 22"></path><path d="M17 7L12 2L7 7"></path><path d="M17 17L12 22L7 17"></path></svg> Altitude</span><strong id="param-altitude">158.2 m</strong></div>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 18 0a9 9 0 1 0-18 0"></path><path d="M12 3L12 12L16 16"></path></svg> Heading</span><strong id="param-heading">285°</strong></div>

            <!-- System Status -->
            <h4 class="param-group-header">System Status</h4>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 18H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2"></path><path d="M19 6h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2"></path><rect width="10" height="12" x="7" y="6" rx="2"></rect></svg> Battery</span><strong id="param-battery" class="status-good">69%</strong></div>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg> GPS Signal</span><strong id="param-gps" class="status-good">Strong</strong></div>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 2h4"></path><path d="M12 14v-4"></path><path d="M4 14h16"></path><path d="M3 22h18"></path><path d="M6 14v-4"></path><path d="M18 14v-4"></path></svg> Flight Time</span><strong id="param-flight-time">08:24:28</strong></div>

            <!-- Environmental -->
            <h4 class="param-group-header">Environmental</h4>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"></path></svg> Temperature</span><strong>19°C</strong></div>
            <div class="param-item"><span><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"></path><path d="M9.6 4.6A2 2 0 1 1 11 8H2"></path><path d="M12.6 19.4A2 2 0 1 0 14 16H2"></path></svg> Wind Speed</span><strong>9.1 m/s</strong></div>

            <!-- Current Position -->
            <h4 class="param-group-header">Current Position</h4>
            <div class="param-item"><span>Latitude</span><strong>--</strong></div>
            <div class="param-item"><span>Longitude</span><strong>--</strong></div>
        </div>
    </div>

    <!-- Column 2: Contains both control panels to toggle between -->
    <div class="control-panel-wrapper">
        <!-- Panel 1: Virtual Joystick Control (MODIFIED) -->
        <div id="joystick-panel" class="card joystick-card">
            <div class="card-header">
                <h3>Virtual Joystick Control</h3>
            </div>
            <div class="card-body">
                <p class="control-description">Drag the joystick to control drone movement and adjust throttle.</p>
                <div id="joystick-container">
                    <div id="joystick-base">
                        <div id="joystick-stick"></div>
                    </div>
                </div>
                <div class="throttle-control">
                    <label for="throttle-slider">Throttle</label>
                    <input id="throttle-slider" class="throttle-slider" type="range" min="0" max="100" value="50">
                    <span class="throttle-value">50%</span>
                </div>
                <div class="control-instructions">
                    <ul>
                        <li>Drag joystick to control horizontal movement.</li>
                        <li>Use throttle slider to control altitude.</li>
                        <li>Release joystick to return to center position.</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Panel 2: Directional Control Pad (NEW) -->
        <div id="directional-panel" class="card directional-card" style="display: none;">
            <div class="card-header">
                <h3>Directional Control Pad</h3>
            </div>
            <div class="card-body">
                <p class="control-description">Use directional buttons for precise movement control.</p>
                <div class="directional-controls-header">
                    <h4>Directional Controls</h4>
                    <div class="mode-switch">
                        <span>Normal</span>
                        <label class="switch">
                            <input type="checkbox">
                            <span class="slider round"></span>
                        </label>
                        <span>Precision</span>
                    </div>
                </div>
                <div class="directional-pad">
                    <button class="d-pad-button rotate-left"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2.5 2v6h6"/><path d="M2.66 15.57a10 10 0 1 0 .57-8.38"/></svg></button>
                    <button class="d-pad-button forward"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg></button>
                    <button class="d-pad-button rotate-right"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21.5 2v6h-6"/><path d="M21.34 15.57a10 10 0 1 1-.57-8.38"/></svg></button>
                    <button class="d-pad-button left"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></button>
                    <button class="d-pad-button center"></button>
                    <button class="d-pad-button right"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></button>
                    <div class="d-pad-placeholder"></div>
                    <button class="d-pad-button backward"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg></button>
                    <div class="d-pad-placeholder"></div>
                </div>
                 <div class="slider-control-group">
                    <label>Movement Speed</label>
                    <div class="slider-wrapper">
                        <input type="range" min="0" max="100" value="100">
                        <span>100%</span>
                    </div>
                </div>
                <div class="quick-actions">
                    <h4>Quick Actions</h4>
                    <button class="btn btn-secondary">Hover</button>
                    <button class="btn btn-secondary">Follow Me</button>
                </div>
                <div class="control-status-display">
                    <span>Control Status</span>
                    <strong class="status-good">READY</strong>
                </div>
            </div>
        </div>
    </div>


    <!-- Column 3: Emergency & Additional Controls (UPDATED) -->
    <div class="card">
        <div class="card-header"><h3>Emergency Controls</h3><span>Critical override functions</span></div>
        <div class="card-body emergency-actions">
            <div class="action-item">
                <div class="action-header">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    <div>
                        <h4>Return to Home</h4>
                        <span>Automatically navigate back to launch point.</span>
                    </div>
                </div>
                <button class="btn btn-secondary">Return to Home</button>
            </div>
            <div class="action-item">
                <div class="action-header">
                     <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"></path><path d="M12 8v8"></path><path d="m8 12 4 4 4-4"></path></svg>
                    <div>
                        <h4>Emergency Landing</h4>
                        <span>Immediate controlled descent to nearest safe zone.</span>
                    </div>
                </div>
                <button class="btn btn-danger">Emergency Landing</button>
            </div>
            <div class="action-item">
                <div class="action-header">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path><line x1="12" y1="2" x2="12" y2="12"></line></svg>
                    <div>
                        <h4>Kill Switch</h4>
                        <span>Immediate motor shutdown - USE ONLY IN EXTREME EMERGENCY.</span>
                    </div>
                </div>
                <button class="btn btn-kill">Kill Switch</button>
            </div>
        </div>
        <!-- Additional Controls (NEW) -->
        <h4 class="param-group-header">Additional Controls</h4>
        <div class="card-body additional-controls">
            <div class="slider-control-group">
                <label>Camera Gimbal</label>
                 <div class="slider-wrapper">
                    <input type="range" min="0" max="90" value="0">
                    <span>0°</span>
                </div>
            </div>
            <div class="slider-control-group">
                <label>LED Brightness</label>
                 <div class="slider-wrapper">
                    <input type="range" min="0" max="100" value="100">
                    <span>100%</span>
                </div>
            </div>
        </div>
        <!-- Communication (NEW) -->
        <h4 class="param-group-header">Communication</h4>
        <div class="card-body communication-controls">
            <div class="toggle-control-group">
                <label>Voice Link</label>
                <div class="status-indicator active"></div>
            </div>
             <div class="toggle-control-group">
                <label>Data Link</label>
                <div class="status-indicator active"></div>
            </div>
        </div>
    </div>
</div>

{% endblock %}